---
import ICONS from '@Assets/Icons.astro';
import MediaThumbs from '@Templates/Media/Thumbs.astro';
interface AlbumViewData {
  title: string;
  description: string;
  shareKey?: string;
  albumSlug: string;
  categoryBadge?: string;
  dateBadge?: string;
  initialThumb?: {
    src?: string;
    width?: number;
    height?: number;
    alt?: string;
    full?: string;
  };
}

interface Props {
  album: AlbumViewData;
  wrapperClass?: string;
  frameClass?: string;
  imageClass?: string;
  isLightbox?: boolean;
  hasTitleOverlay?: boolean;
  autoplay?: boolean;
  random?: boolean;
  interval?: number;
}

const {
  album,
  wrapperClass,
  frameClass,
  imageClass,
  isLightbox = false,
  hasTitleOverlay = false,
  autoplay = true,
  random = true,
  interval = 8500,
} = Astro.props as Props;

---
<div
  class:list={[
    'media-wrapper',
    'media-wrapper',
    wrapperClass,
  ]}
  data-lightbox={isLightbox ? 'true' : undefined}
>
  <div
    class:list={['media-frame', frameClass]}
    data-slug={album.albumSlug}
    data-autoplay={autoplay ? 'true' : 'false'}
    data-interval={String(interval)}
    data-random={random ? 'true' : 'false'}
    data-share-key={album.shareKey}
    role="button"
    tabindex="0"
    aria-label="Open artwork in lightbox"
    data-lightbox={isLightbox ? 'true' : undefined}>
    <img
      src={album.initialThumb?.src ?? ''}
      width={album.initialThumb?.width}
      height={album.initialThumb?.height}
      alt={album.initialThumb?.alt ?? ''}
      class:list={['media-image', isLightbox ? 'media-lightbox-image' : undefined,imageClass]}
      loading="eager"
      decoding="async"
      data-initial-full={album.initialThumb?.full ?? undefined}
      data-lightbox={isLightbox ? 'true' : undefined}
   />

  <div class="card__overlay card__overlay--foot card__overlay--hover">
    <div class="card__overlay-item media-progress" aria-hidden="true"></div>
    <div class="card__overlay-item controls media-controls controls--center">  
      <button class="control control--button control--circle control--media media-prev is-thumbs-prev" aria-label="Previous thumbnails" type="button">
        <ICONS kind="previous" />
      </button>
      <button class="control control--button control--circle control--media media-pause" aria-label="Pause autoplay" type="button">
        <ICONS class="media-icon media-icon--small" kind="pause" />
      </button>
      <button class="control control--button control--circle control--media media-play" aria-label="Start autoplay" type="button">
        <ICONS class="media-icon media-icon--small" kind="play" />
      </button>
      <button class="control control--button control--circle control--media media-next is-thumbs-next" aria-label="Next thumbnails" type="button">
        <ICONS kind="next" />
      </button>

      <button class:list={['control', 'control--button', 'control--circle', 'control--media', isLightbox ? 'media-lightbox__close' : 'media-fullscreen']} 
              aria-label={isLightbox ? "Close Lightbox" : "Open Lightbox"} 
              type="button">
              
              <ICONS class="media-icon media-icon--small" kind={isLightbox ? "close" : "fullscreen"} />
      </button>

    </div>
  </div>

  {album.title && hasTitleOverlay ? (
  <div class="card__overlay card__overlay--head card__overlay--hover">
    <div class="card__overlay-item">    
 
      <h2>
        {album.title.includes('SFW') ? `Artworks: ${album.title}` : album.title}
      </h2>
    {(album.categoryBadge || album.dateBadge) && (
      <div class="card__badges controls controls--end">
        <span class="control control--badge">
          {album.categoryBadge ? album.categoryBadge : album.dateBadge}
        </span>
      </div>
    )}
  </div>
</div>):null}

  </div> {isLightbox ? <MediaThumbs isLightbox={isLightbox} /> : null}</div>

      






