---
import { Template } from '@Frontend';
import ICONS from '@Assets/Icons.astro';

interface AlbumViewData {
  title: string;
  description: string;
  shareKey?: string;
  albumSlug: string;
  categoryBadge?: string;
  dateBadge?: string;
  initialThumb?: {
    src?: string;
    width?: number;
    height?: number;
    alt?: string;
    full?: string;
  };
}

interface Props {
  album: AlbumViewData;
  cardClass?: string;
  frameClass?: string;
  imageClass?: string;
}

const { album, cardClass, frameClass, imageClass } = Astro.props as Props;

---
<Template.Card class:list={['card--flush', 'card--ghost', 'is-centered', cardClass]} headClass="card__head--column">
  {album.description ? (
    <Fragment slot="body">
      <div class="prose">
        <p>{album.description}</p>
      </div>
    </Fragment>
  ) : null}

  <Fragment slot="body">
    <div class="media-wrapper media-wrapper--controls">
      <div
        class:list={['media-frame', frameClass]}
        data-slug={album.albumSlug}
        data-autoplay="true"
        data-interval="8500"
        data-random="true"
        data-share-key={album.shareKey}
        role="button"
        tabindex="0"
        aria-label="Open artwork in lightbox"
      >
        <img
          src={album.initialThumb?.src ?? ''}
          width={album.initialThumb?.width}
          height={album.initialThumb?.height}
          alt={album.initialThumb?.alt ?? ''}
          class:list={['media-image', imageClass]}
          loading="eager"
          decoding="async"
          data-initial-full={album.initialThumb?.full ?? undefined}
        />
      </div>

      <div class="card__overlay card__overlay--controls card__overlay--bottom card__overlay--hover">
        <div class="controls controls--center controls--tight">
          <button class="control--button media-controls media-prev" aria-label="Previous" type="button">❮</button>
          <button class="control--button media-controls media-pause" aria-label="Pause autoplay" type="button">
            <ICONS class="media-icon media-icon--small" kind="pause" />
          </button>
          <button class="control--button media-controls media-play" aria-label="Start autoplay" type="button">
            <ICONS class="media-icon media-icon--small" kind="play" />
          </button>          
          <button class="control--button media-controls media-next" aria-label="Next" type="button">❯</button>
        </div>
        <div class="controls controls--end">
          <button class="control--button media-controls media-fullscreen" aria-label="Open Lightbox" type="button">
            <ICONS class="media-icon media-icon--small" kind="fullscreen" />
          </button>            
        </div>
        <div class="media-progress" aria-hidden="true"></div>
      </div>

      <div class="card__overlay card__overlay--title card__overlay--top card__overlay--hover">
        <h1 class="card__title">
          {album.title && (album.title.includes('SFW') || album.title.includes('NSFW'))
          ? `Artworks: ${album.title}`  
          : album.title} 
        </h1>
        {(album.categoryBadge || album.dateBadge) && (
          <div class="card__badges controls controls--end">
            {album.categoryBadge ? <span class="control control--badge">{album.categoryBadge}</span> : null}
            {album.dateBadge ? <span class="control control--badge">{album.dateBadge}</span> : null}

          </div>
        )}
      </div>
    </div>
  </Fragment>
</Template.Card>





