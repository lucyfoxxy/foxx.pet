---
import { getNavLabelParts, getPageContent } from '@Content/siteContent';
import Card from '@Templates/Card.astro';
import TitleWithIcon from '@Templates/partials/TitleWithIcon.astro';

const content = await getPageContent('imprint');
const introParagraphs = content.introParagraphs ?? [];
const contacts = content.contacts ?? [];
const disclaimer = content.disclaimer ?? [];
const { icon, emoji } = getNavLabelParts(content);
---

  <section class="content-section">
    <Card class="card--plain is-centered">
      <Fragment slot="head">
        <TitleWithIcon class="card__title" title={content.title} icon={icon} emoji={emoji} />
      </Fragment>
      <Fragment slot="body">
        <div class="prose">
          {introParagraphs.map((paragraph) => (
            <p>{paragraph}</p>
          ))}
        </div>
      </Fragment>
    </Card>
  </section>

  <section class="content-section cols-2">
    {contacts.map((contact) => (
      <Card>
        <Fragment slot="head">
          <h2 class="card__title">{contact.title}</h2>
        </Fragment>
        <Fragment slot="body">
          {contact.subtitle && (
            <p><em>{contact.subtitle}</em></p>
          )}
          <dl class="deflist">
            {contact.entries.flatMap((entry) => [
              <dt class="deflist__term">{entry.term}</dt>,
              <dd class="deflist__desc">
                {entry.kind === 'mail' ? (
                  <a href={`mailto:${entry.description}`}>{entry.description}</a>
                ) : (
                  entry.description
                )}
              </dd>,
            ])}
          </dl>
        </Fragment>
      </Card>
    ))}
  

    {disclaimer.length > 0 && (
      <Card>
        <Fragment slot="head">
          <h2 class="card__title">Disclaimer</h2>
        </Fragment>
        <Fragment slot="body">
          <div class="prose">
            {disclaimer.map((paragraph) => (
              <p>
                <em>{paragraph}</em>
              </p>
            ))}
          </div>
        </Fragment>
      </Card>
    )}
  </section>
