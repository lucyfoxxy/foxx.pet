---
import Layout from '@Layout/Main.astro';
import Icon from '@Assets/Icons.astro';
import { ASSETS } from '@Assets/ui';
import { getPageContent } from '@Content/siteContent';
import Card from '@Layout/Card.astro';
import { Picture } from 'astro:assets';
export const prerender = true;

const content = await getPageContent('home');

const meta = {
  title: content.title,
  description: content.description,
};

const hero = {
  ...content.hero,
  logo: ASSETS.logo_hero,
  image: ASSETS.logo_hero.src,
};

const intro = content.intro;
const feature = content.feature;
const links = content.contactLinks ?? [];
const contact = content.contact;
const albumSlug = 'bestof';
const shareKey = 'KEkdKYpvFNPFgS654sbWB28rHuXIohcLo5MtrD1BERFqwHOtrQjmDxMhsRTnRSsKRSw';
const isExternalLink = (href: string) => href.startsWith('http');
---
<Layout meta={meta}>
  <head>
    <link rel="preload" href={hero.image} as="image" type="image/webp" />
  </head>

  <section class="content-section">
    <Card class="card--plain is-centered is-condensed">
      <Fragment slot="head">
        <h1 class="card__title">{hero.heading}</h1>
      </Fragment>
      <Fragment slot="body">
        <Picture
          src={hero.logo}
          formats={['webp']}
          inferSize
          alt={hero.heading}
          fetchpriority="high"
          class="media-image hero"
        />       
      </Fragment>
      <Fragment slot="foot">
        <h2><em>...Eeeeeeeeeeeeeeeeeeeeek!</em></h2>
      </Fragment>
    </Card>
  </section>

  <section class="content-section cols-2">
    <section class="content-section">
      <Card>
        <Fragment slot="head">
          <h2 class="card__title">{intro.heading}</h2>
        </Fragment>
        <Fragment slot="body">
          <div class="prose">
            {intro.paragraphs.map((paragraph) => <p>{paragraph}</p>)}
            
          </div>
        </Fragment>
        <Fragment slot="foot">
          <div class="prose">
            <p>
              - Always follow your heart -
            </p>
          
          <h3 class="is-italic">{intro.signature}</h3>
          </div>
        </Fragment>
      </Card>
      <Card class="card--light" headClass="card__head--column">
        <Fragment slot="head">
          <h2 class="card__title">{contact.heading}</h2>
          <p>{contact.description}</p>
        </Fragment><Fragment slot="body">
          <div class="controls controls--start">
            {links.map((link) => (
              <a
                class={`button button--dark button--large button--large--${link.kind}`}
                href={link.href}
                rel={isExternalLink(link.href) ? 'noopener noreferrer' : undefined}
                target={isExternalLink(link.href) ? '_blank' : undefined}
              >
                <span class="button__icon"><Icon kind={link.kind} /></span>

              </a>
            ))}
          </div>
        </Fragment>
      </Card>
    </section>
    <Card class="card--light" headClass="card__head--column">
      <Fragment slot="head">
        <h2 class="card__title">{feature.heading}</h2>
        <p>{feature.description}</p>
      </Fragment>
      <Fragment slot="foot">
      <div class="media-wrapper">
        <div
          class="media-frame compact"
          data-slug={albumSlug}
          data-autoplay="true"
          data-interval="8000"
          data-random="true"
          data-share-key={shareKey}
          role="button" 
          tabindex="0" 
          aria-label="Open artwork in lightbox"
        >
     
          <img class="media-image compact" alt="" />
          <div class="media-progress" aria-hidden="true"></div>
        </div>
        </div>
      </Fragment>
    </Card>
  </section>


  <script>
    import initGalleryIntro from '@Scripts/galleryViewer_compact.js';
    import { runOnReady } from '@Scripts/utils/_runOnReady.js';
    runOnReady(initGalleryIntro);
  </script>
</Layout>
