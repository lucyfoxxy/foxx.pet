---
import { View } from '@Frontend';
import { isAlbumEntry } from '@utils/getEntries';
import { buildSectionEntryStaticPaths } from '@utils/sectionPaths';

export async function getStaticPaths() {
  return buildSectionEntryStaticPaths('tails', (entry) => {
    if (isAlbumEntry(entry)) {
      return null;
    }

    const segments = entry.slug.split('/').filter(Boolean);
    const entrySegment = segments[segments.length - 1] ?? entry.data.slug ?? entry.slug;
    const categorySegment = entry.data.category ?? 'general';
    return {
      category: categorySegment,
      entry: entrySegment,
    };
  });
}

const { entry } = Astro.params;

if (!entry) {
  throw new Error('Missing blog article slug');
}
---
<View.Entry section="tails" slug={entry} />
