---
import ContentView from '@Templates/ContentView.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const albums = await getCollection('album');
  return albums
    .filter(({ data }) => data.slug && data.category?.slug)
    .map(({ data }) => ({
      params: {
        category: data.category!.slug,
        album: data.slug,
      },
    }));
}

const { album } = Astro.params;

if (!album) {
  throw new Error('Missing album slug');
}
---
<ContentView slug={album} />
