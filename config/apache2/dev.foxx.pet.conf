<VirtualHost *:80>
  ServerName dev.foxx.pet
  RewriteEngine On
  RewriteRule ^ https://dev.foxx.pet%{REQUEST_URI} [R=301,L]
RewriteCond %{SERVER_NAME} =dev.foxx.pet
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

<VirtualHost *:443>
  ServerName dev.foxx.pet
  DocumentRoot /var/www/dev.foxx.pet/public

  # immich_kiosk ReverseProxy 
  ProxyPreserveHost On
  ProxyRequests Off
 
  # CSP	
 Header set Content-Security-Policy "default-src 'self'; img-src 'self' https://i.foxx.pet https://img.foxx.pet data: blob:; media-src 'self' https://i.foxx.pet https://img.foxx.pet; connect-src 'self' https://i.foxx.pet https://img.foxx.pet; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' data: https://fonts.gstatic.com; frame-src 'self'; script-src 'self'; object-src 'none'; base-uri 'self'; frame-ancestors 'none'"  

  # dev: bitte nicht indexieren
  Header always set X-Robots-Tag "noindex, nofollow"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
  Header always set X-Content-Type-Options "nosniff"
  Header always set X-Frame-Options "SAMEORIGIN"
  
  <Directory /var/www/dev.foxx.pet/public>
    Options -Indexes
    AllowOverride All
    Require all granted
  </Directory>

  SSLEngine on
	Include	/etc/letsencrypt/options-ssl-apache.conf
	SSLCertificateFile /etc/letsencrypt/live/foxx.pet-0001/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/foxx.pet-0001/privkey.pem
</VirtualHost>
