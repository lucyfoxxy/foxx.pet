<VirtualHost *:80>
  ServerName foxx.pet
  ServerAlias cosmic.foxx.pet lucy.foxx.pet
  RewriteEngine On
  RewriteRule ^ https://foxx.pet%{REQUEST_URI} [R=301,L]
RewriteCond %{SERVER_NAME} =lucy.foxx.pet [OR]
RewriteCond %{SERVER_NAME} =cosmic.foxx.pet [OR]
RewriteCond %{SERVER_NAME} =foxx.pet
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

<VirtualHost *:443>
  ServerName foxx.pet
  ServerAlias cosmic.foxx.pet lucy.foxx.pet
  DocumentRoot /var/www/foxx.pet/public

  # immich_kiosk ReverseProxy 
  ProxyPreserveHost On
  ProxyRequests Off
 
  # CSP	
  Header set Content-Security-Policy "default-src 'self'; img-src 'self' https://i.foxx.pet https://img.foxx.pet https://stats.foxx.pet data: blob:; media-src 'self' https://i.foxx.pet https://img.foxx.pet; connect-src 'self' https://i.foxx.pet https://img.foxx.pet https://stats.foxx.pet; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' data: https://fonts.gstatic.com; frame-src 'self'; script-src 'self' 'unsafe-inline'; object-src 'none'; base-uri 'self'; frame-ancestors 'none'"

  <Directory /var/www/foxx.pet/public>
    Options -Indexes
    AllowOverride All
    Require all granted
  </Directory>

  SSLEngine on
	Include	/etc/letsencrypt/options-ssl-apache.conf
	SSLCertificateFile /etc/letsencrypt/live/foxx.pet-0001/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/foxx.pet-0001/privkey.pem
</VirtualHost>
